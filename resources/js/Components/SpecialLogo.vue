<template>
    <div id="logo-container" class="lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw] relative items-center overflow-hidden ml-[10vw]  rounded-md">
        <div id="logo-background" class="absolute z-[98] w-full h-full block p-4 top-0 left-0 bg-white rounded-lg shadow-lg border-2 border-white transition-all duration-250 ease-in-out">
            <div class="ripple"></div>
        </div>
        <div class="overflow-hidden lg:h-[3.96vw] h-[7.92vw] rounded-xl">
            <div id="logo-background2"
                 class="absolute z-[98] lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw] block top-0 left-0 bg-transparent rounded-lg shadow-lg border-2 border-white transition-all duration-250 ease-in-out">
            </div>
            <div class="relative">
                <svg id="joebeze_logo_lazer_anim" class="absolute lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw] z-[99] top-[0.68vw] left-[0.73vw]" data-name="joebeze_logo_lazer_anim"
                     xmlns="http://www.w3.org/2000/svg" viewBox="0 0 650 76.27">
                    <defs>
                    </defs>
                    <path class="cls-1"
                          d="M26.82,4.59v24.75c0,7.56-3.98,13.05-14,13.05H0v-6.61h12.43c5.94,0,7.73-2.86,7.73-6.5V4.59h6.66Z"/>
                    <path class="cls-1"
                          d="M52.92,12.82c7.84,0,12.82,4.82,12.82,14.78s-4.98,14.78-12.82,14.78h-6.22c-7.9,0-12.82-4.82-12.82-14.78s4.93-14.78,12.82-14.78h6.22Z"/>
                    <path class="cls-1"
                          d="M47.26,18.54c-5.15,0-7.39,2.69-7.39,9.07s2.24,9.02,7.39,9.02h5.1c5.1,0,7.39-2.63,7.39-9.02s-2.3-9.07-7.39-9.07h-5.1Z"/>
                    <path class="cls-1"
                          d="M92.12,12.82c7,0,9.97,3.36,9.97,9.07s-2.74,8.51-10.02,8.51h-14.06v2.13c0,2.35,1.29,4.09,4.54,4.09h18.09v5.77h-18.09c-7.39,0-10.3-4.14-10.3-9.74v-10.08c0-5.6,2.91-9.74,10.3-9.74h9.58Z"/>
                    <path class="cls-1"
                          d="M78.01,25.76h13.89c3.19,0,4.37-1.34,4.37-3.53s-1.29-3.7-4.2-3.7h-9.52c-3.25,0-4.54,1.79-4.54,4.09v3.14Z"/>
                    <path class="cls-1"
                          d="M115.3,0v12.82h13.1c7.84,0,12.77,4.82,12.77,14.78s-4.93,14.78-12.77,14.78h-8.18c-7.11,0-10.86-4.14-10.86-12.66V0h5.94Z"/>
                    <path class="cls-1"
                          d="M115.3,18.54v10.92c0,5.04,1.85,7.17,6.66,7.17h5.82c5.15,0,7.39-2.63,7.39-9.02s-2.24-9.07-7.39-9.07h-12.49Z"/>
                    <path class="cls-1"
                          d="M167.55,12.82c7,0,9.97,3.36,9.97,9.07s-2.74,8.51-10.02,8.51h-14.06v2.13c0,2.35,1.29,4.09,4.54,4.09h18.09v5.77h-18.09c-7.39,0-10.3-4.14-10.3-9.74v-10.08c0-5.6,2.91-9.74,10.3-9.74h9.58Z"/>
                    <path class="cls-1"
                          d="M153.44,25.76h13.89c3.19,0,4.37-1.34,4.37-3.53s-1.29-3.7-4.2-3.7h-9.52c-3.25,0-4.54,1.79-4.54,4.09v3.14Z"/>
                    <path class="cls-1"
                          d="M204.01,12.82c5.15,0,7.62,2.69,7.62,6.78,0,3.64-1.96,5.99-5.04,7.11l-16.97,6.16c-1.01.39-1.57,1.06-1.57,2.02,0,1.12.73,1.79,2.24,1.79h20.72v5.71h-21.06c-5.1,0-7.62-2.69-7.62-6.78,0-3.3,1.62-5.94,5.04-7.17l17.02-6.1c1.23-.45,1.57-1.29,1.57-2.07,0-1.12-.73-1.74-2.3-1.74h-20.27v-5.71h20.61Z"/>
                    <path class="cls-1"
                          d="M237.27,12.82c7,0,9.97,3.36,9.97,9.07s-2.74,8.51-10.02,8.51h-14.06v2.13c0,2.35,1.29,4.09,4.54,4.09h18.09v5.77h-18.09c-7.39,0-10.3-4.14-10.3-9.74v-10.08c0-5.6,2.91-9.74,10.3-9.74h9.58Z"/>
                    <path class="cls-1"
                          d="M223.16,25.76h13.89c3.19,0,4.37-1.34,4.37-3.53s-1.29-3.7-4.2-3.7h-9.52c-3.25,0-4.54,1.79-4.54,4.09v3.14Z"/>
                    <path class="cls-1"
                          d="M299.93,0v29.74c0,8.51-3.81,12.66-10.86,12.66h-8.18c-7.9,0-12.82-4.82-12.82-14.78s4.93-14.78,12.82-14.78h13.05V0h5.99Z"/>
                    <path class="cls-1"
                          d="M293.94,29.46v-10.92h-12.49c-5.1,0-7.39,2.69-7.39,9.07s2.3,9.02,7.39,9.02h5.88c4.76,0,6.61-2.13,6.61-7.17Z"/>
                    <path class="cls-1"
                          d="M327.65,12.82c7,0,9.97,3.36,9.97,9.07s-2.74,8.51-10.02,8.51h-14.06v2.13c0,2.35,1.29,4.09,4.54,4.09h18.09v5.77h-18.09c-7.39,0-10.3-4.14-10.3-9.74v-10.08c0-5.6,2.91-9.74,10.3-9.74h9.58Z"/>
                    <path class="cls-1"
                          d="M313.54,25.76h13.89c3.19,0,4.37-1.34,4.37-3.53s-1.29-3.7-4.2-3.7h-9.52c-3.25,0-4.54,1.79-4.54,4.09v3.14Z"/>
                    <path class="cls-1"
                          d="M346.97,12.82l9.86,23.74c.22.62.73.9,1.46.9.78,0,1.29-.28,1.57-.9l10.25-23.74h6.38l-11.42,26.38c-1.23,2.8-3.42,3.86-6.78,3.86s-5.6-1.12-6.72-3.86l-10.86-26.38h6.27Z"/>
                    <path class="cls-1"
                          d="M402.69,0v12.82h13.1c7.84,0,12.77,4.82,12.77,14.78s-4.93,14.78-12.77,14.78h-8.18c-7.11,0-10.86-4.14-10.86-12.66V0h5.94Z"/>
                    <path class="cls-1"
                          d="M402.69,18.54v10.92c0,5.04,1.85,7.17,6.66,7.17h5.82c5.15,0,7.39-2.63,7.39-9.02s-2.24-9.07-7.39-9.07h-12.49Z"/>
                    <path class="cls-1" d="M441.61,0v42.39h-5.94V0h5.94Z"/>
                    <path class="cls-1"
                          d="M467.76,12.82c7.84,0,12.82,4.82,12.82,14.78s-4.98,14.78-12.82,14.78h-6.22c-7.9,0-12.82-4.82-12.82-14.78s4.93-14.78,12.82-14.78h6.22Z"/>
                    <path class="cls-1"
                          d="M462.11,18.54c-5.15,0-7.39,2.69-7.39,9.07s2.24,9.02,7.39,9.02h5.1c5.1,0,7.39-2.63,7.39-9.02s-2.3-9.07-7.39-9.07h-5.1Z"/>
                    <path class="cls-1"
                          d="M507.3,12.82c7.06,0,10.86,4.14,10.86,12.66v17.02c0,8.4-2.91,11.7-11.2,11.7h-17.58v-5.71h16.91c4.42,0,5.88-1.74,5.88-5.99v-1.34h-13.05c-7.9,0-12.82-4.65-12.82-14.22s4.93-14.11,12.82-14.11h8.18Z"/>
                    <path class="cls-1"
                          d="M499.68,35.78h12.49v-10.36c0-4.82-1.85-6.89-6.61-6.89h-5.88c-5.1,0-7.39,2.58-7.39,8.62s2.3,8.62,7.39,8.62Z"/>
                </svg>
            </div>
            <div class="relative">
                <svg id="joebeze_logo_filled" class="absolute lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw] z-[99] top-[0.47vw] left-[0.78vw]" data-name="joebeze_logo_filled" xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 650 76.27">
                    <defs>
                        <pattern id="tessPattern" patternUnits="userSpaceOnUse" width="256" height="256">
                            <image :href="tessSrc" width="256"
                                   height="256" preserveAspectRatio="xMidYMid slice"/>
                        </pattern>
                        <pattern id="fillPattern" patternUnits="userSpaceOnUse" width="100%" height="100%">
                            <image :href="tessPatternSrc" width="100%"
                                   height="100%" preserveAspectRatio="xMidYMid slice"/>
                        </pattern>
                    </defs>
                    <text class="cls-2-1" transform="translate(0 46.9)">
                        <tspan x="0" y="0">Joeb</tspan>
                        <tspan class="cls-2-3" x="145.65" y="0">e</tspan>
                        <tspan class="cls-2-2" x="181.1" y="0">z</tspan>
                        <tspan x="215.37" y="0">e d</tspan>
                        <tspan class="cls-2-4" x="305.76" y="0">e</tspan>
                        <tspan x="341.26" y="0">v blog</tspan>
                    </text>
                </svg>
            </div>
            <div class="relative">
                <svg id="ripple-effect-bg" class="z-20 absolute lg:top-[-18.33vw] top-[-36.66vw]  lg:left-[-4.17vw] left-[-8.34vw] w-[98.96vw] lg:w-[49.48vw] h-[83.34vw] lg:h-[41.67vw] rounded-md shadow-lg border-2 border-white transition-all duration-1000 ease-in-out"
                     data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1070.78 901.04">
                    <defs>
                        <clipPath id="clippath">
                            <circle id="_EllipseWhite10_" data-name="&lt;EllipseWhite10&gt;" class="cls-3-2" cx="-100" cy="-100" r="1"/>
                        </clipPath>
                        <clipPath id="clippath-1">
                            <circle class="cls-3-2" cx="-100" cy="-100" r="1"/>
                        </clipPath>
                        <!--            <clipPath id="clippath-2">-->
                        <!--                <circle class="cls-3-2" cx="-100" cy="-100" r="1"/>-->
                        <!--            </clipPath>-->
                        <clipPath id="clippath-3">
                            <circle class="cls-3-2" cx="-100" cy="-100" r="1"/>
                        </clipPath>
                        <clipPath id="clippath-4">
                            <circle class="cls-3-2" cx="-100" cy="-100" r="1"/>
                        </clipPath>
                        <clipPath id="clippath-5">
                            <circle class="cls-3-2" cx="-100" cy="-100" r="1"/>
                        </clipPath>
                    </defs>
                    <g id="_Clip_Group_Redhead_" data-name="&lt;Clip Group Redhead&gt;">
                        <g class="cls-3-5">
                            <image id="redhead" width="1017" height="256" transform="translate(80.85 340) scale(.76)"/>
                        </g>
                    </g>
                    <g id="_Clip_Group_Blueninja_" data-name="&lt;Clip Group Blueninja&gt;">
                        <g class="cls-3-3">
                            <image id="blueninja" width="1017" height="256" transform="translate(80.85 340) scale(.76)"/>
                        </g>
                    </g>
                    <!--        <g id="_Clip_Group_Darkgame_" data-name="&lt;Clip Group Darkgame&gt;">-->
                    <!--            <g class="cls-3-1">-->
                        <!--                <image width="640" height="360" transform="translate(150.31 277.3) scale(1.05)" xlink:href="{{ asset('images/dark-game.gif') }}"/>-->
                        <!--            </g>-->
                    <!--        </g>-->
                    <g id="_Clip_Group_Blackcat_" data-name="&lt;Clip Group Blackcat&gt;">
                        <g class="cls-3-6">
                            <image id="blackcat" width="1017" height="256" transform="translate(80.85 331.18) scale(.76)"/>
                        </g>
                    </g>
                    <g id="_Clip_Group_Tanwoman_" data-name="&lt;Clip Group Tanwoman&gt;">
                        <g class="cls-3-4">
                            <image id="tanwoman" width="1017" height="256" transform="translate(80.85 331.18) scale(.76)"/>
                        </g>
                    </g>
                    <g id="_Clip_Group_Orangewoman_" data-name="&lt;Clip Group Orangewoman&gt;">
                        <g class="cls-3-7">
                            <image id="orangewoman" width="1017" height="256" transform="translate(80.85 331.18) scale(.76)"/>
                        </g>
                    </g>
                </svg>
            </div>
            <canvas id="canvas" class="absolute top-0 left-0 lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw]"></canvas>
            <canvas id="canvas2" class="z-[99] absolute top-0 left-0 lg:h-[3.96vw] h-[7.92vw] lg:w-[33.85vw] w-[67.70vw]"></canvas>
        </div>
    </div>
</template>

<script setup>

import {onMounted, onUpdated} from "vue";
const tessSrc = '/images/bytebeze-banner-tess.png';
const tessPatternSrc = '/images/bytebeze-banner-tess.png';


onMounted(() => {

    class Particle {
        constructor(x, y, size, color) {
            this.speed = 0.6;
            this.x = x;
            this.y = y;
            this.vx = (Math.random() - 0.5) * this.speed;
            this.vy = (Math.random() - 0.5) * this.speed;
            this.opacity = 1;
            this.size = size;
            this.color = color;
        }

        draw(context) {
            this.opacity -= this.speed / 200;
            context.fillStyle = this.color.replace('rgb', 'rgba').replace(')', `, ${this.opacity})`);
            context.beginPath();
            context.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            context.fill();
        }

        move() {
            this.x += this.vx;
            this.y += this.vy + (1 - this.opacity) * this.speed;
        }
    }

    class Laser {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.steps = [];
            this.particles = [];
            this.sparkParticles = [];
        }

        drawTo(x, y, ctx) {
            ctx.beginPath();
            ctx.moveTo(this.x, this.y);
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.fillStyle = "red";
            ctx.fillRect(x + 12, y + 10, 5, 5); // Adjust the position of the dot
        }

        drawEnd(ctx) {
            var p = this.steps.shift();
            if (p !== undefined) {
                this.drawTo(p[0], p[1], ctx);
                this.generateSparkParticles(p[0], p[1]);
            } else {
                var index = this.particles.length;
                while (index--) {
                    var p = this.particles[index];
                    p.move();
                    if (p.opacity < 0 || p.x < 0 || p.x > ctx.canvas.width || p.y < 0 || p.y > ctx.canvas.height) {
                        this.particles.splice(index, 1);
                    } else {
                        p.draw(ctx);
                    }
                }

                var sparkIndex = this.sparkParticles.length;
                while (sparkIndex--) {
                    var sparkParticle = this.sparkParticles[sparkIndex];
                    sparkParticle.move();
                    if (sparkParticle.opacity < 0 || sparkParticle.x < 0 || sparkParticle.x > ctx.canvas.width || sparkParticle.y < 0 || sparkParticle.y > ctx.canvas.height) {
                        this.sparkParticles.splice(sparkIndex, 1);
                    } else {
                        sparkParticle.draw(ctx);
                    }
                }
            }
        }

        endFrom(x0, y0) {
            var nrOfSteps = 800;
            var i = nrOfSteps;
            while (i--) {
                var x = this.x + i * (x0 - this.x) / nrOfSteps + Math.cos(i / 10) * i / 4;
                var y = this.y + i * (y0 - this.y) / nrOfSteps + Math.sin(i / 10) * i / 4;
                this.steps.push([x, y]);
                if (i < 100) {
                    this.particles.push(new Particle(x, y, 2, 'rgb(0, 255, 0)'));
                }
            }
        }

        generateSparkParticles(x, y) {
            var numSparkParticles = 10;
            for (var i = 0; i < numSparkParticles; i++) {
                var size = Math.random() * 3 + 1;
                var sparkParticle = new Particle(x, y, size, 'rgb(255, 255, 0)');
                sparkParticle.vx = (Math.random() - 0.5) * 2;
                sparkParticle.vy = (Math.random() - 0.5) * 2;
                this.sparkParticles.push(sparkParticle);
            }
        }
    }


    class LaserWriter {
        constructor(canvasId, canvas2Id, svgId) {
            var canvas = document.getElementById(canvasId);
            var canvas2 = document.getElementById(canvas2Id);
            this.svg = document.getElementById(svgId);
            this.ctx = canvas.getContext("2d");
            this.ctx2 = canvas2.getContext("2d");
            this.tick = 0;
            this.pathIndex = 0;
            this.pointIndex = 0;
            this.paths = [];
            this.size = 3;
            this.initCanvasSize();
        }


        initCanvasSize() {
            const viewBox = this.svg.viewBox.baseVal;
            const scaleFactor = window.devicePixelRatio || 1;

            this.w = viewBox.width * scaleFactor;
            this.h = viewBox.height * scaleFactor;

            this.ctx.canvas.width = this.w;
            this.ctx.canvas.height = this.h;
            this.ctx2.canvas.width = this.w;
            this.ctx2.canvas.height = this.h;
        }

        init(text, size) {
            // Set font size for the text
            this.ctx.font = `${size}px nasalisation`;
            // Calculate starting X position to center the text
            this.startX = (this.w - this.ctx.measureText(text).width) / 2;
            // Draw text onto the canvas
            this.ctx.fillText(text, this.startX, 100);

            // Get the imageData of the text
            var image = this.ctx.getImageData(0, 0, this.w, this.h);
            var buffer32 = new Uint32Array(image.data.buffer);

            // Clear the canvas after getting the image data
            this.ctx.clearRect(0, 0, this.w, this.h);

            // Set the laser beam styles
            this.ctx2.strokeStyle = "rgba(20, 255, 70, 1)";
            this.ctx2.lineCap = "round";
            this.ctx2.lineWidth = 4;

            // Find the top-left non-zero pixel to set the laser start position
            let startX = this.w, startY = this.h; // Initialize with max values
            for (let y = 0; y < this.h; y++) {
                for (let x = 0; x < this.w; x++) {
                    if (buffer32[y * this.w + x]) {
                        startX = Math.min(startX, x);
                        startY = Math.min(startY, y);
                    }
                }
            }

            // Initialize the laser at the top-left of the text
            this.laserStart.x = startX;
            this.laserStart.y = startY;
            this.laser = new Laser(this.laserStart.x, this.laserStart.y);
            // Iterate over every pixel to find where the text is drawn
            for (var y = 0; y < this.h; y++) {
                for (var x = 0; x < this.w; x++) {
                    if (buffer32[y * this.w + x]) {
                        this.points.push([x, y]);
                    }
                }
            }
        }

        draw() {
            this.ctx2.clearRect(0, 0, this.w, this.h);

            if (this.pathIndex < this.paths.length - 1) {
                const path = this.paths[this.pathIndex];
                const p = path.points[this.pointIndex];

                if (p) {
                    this.x = p[0];
                    this.y = p[1];
                    this.laser.drawTo(this.x, this.y, this.ctx2);

                    const segmentLength = path.path.getTotalLength() / path.points.length;
                    const distance = this.pointIndex * segmentLength;
                    path.path.style.strokeDasharray = `${distance} ${path.path.getTotalLength()}`;
                    path.path.style.stroke = '#fff';
                    path.path.style.strokeWidth = '2px';
                }

                if (this.pointIndex === path.points.length - 1) {
                    this.pathIndex++;
                    this.pointIndex = 0;
                } else if (this.pointIndex > path.points.length) {
                    this.pointIndex = path.points.length - 1;
                } else {
                    this.pointIndex += 6.5;
                }
            } else if (this.pathIndex === this.paths.length - 1) {
                const borderPath = this.paths[this.pathIndex];
                const p = borderPath.points[this.pointIndex];

                if (p) {
                    this.x = p[0];
                    this.y = p[1];
                    this.laser.drawTo(this.x, this.y, this.ctx2);
                }

                if (this.pointIndex === borderPath.points.length - 1) {
                    this.pathIndex++;
                    this.pointIndex = 0;
                } else {
                    this.pointIndex++;
                }
            } else if (this.pathIndex === this.paths.length) {
                this.laser.endFrom(this.x, this.y);

                this.pathIndex++;
            } else {
                this.laser.drawEnd(this.ctx2);
            }

            if (this.pathIndex <= this.paths.length) {
                requestAnimationFrame(() => this.draw());
            }
        }

        traceBorder() {
            const logoBackground = document.getElementById('logo-background');
            const logoBackgroundRect = logoBackground.getBoundingClientRect();

            const borderPoints = [
                [logoBackgroundRect.left, logoBackgroundRect.top],
                [logoBackgroundRect.right, logoBackgroundRect.top],
                [logoBackgroundRect.right, logoBackgroundRect.bottom],
                [logoBackgroundRect.left, logoBackgroundRect.bottom],
                [logoBackgroundRect.left, logoBackgroundRect.top]
            ];

            const borderPath = {
                points: borderPoints
            };

            this.paths.push(borderPath);
        }

        traceSVG() {
            const paths = this.svg.querySelectorAll('path');
            paths.forEach(path => {
                path.style.stroke = 'transparent';
                path.style.fill = 'transparent'; // Set initial fill to transparent
                const pathPoints = [];
                const length = path.getTotalLength();
                const numPoints = Math.floor(length); // Increase the number of points
                for (let i = 0; i < numPoints; i++) {
                    const point = path.getPointAtLength(i * length / (numPoints - 1));
                    pathPoints.push([point.x, point.y]);
                }
                this.paths.push({path, points: pathPoints});
            });

            this.laser = new Laser(this.paths[0].points[0][0], this.paths[0].points[0][1]);
        }
    }
    var lastMousePosition = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
    document.addEventListener('mousemove', (event) => {
        lastMousePosition.x = event.clientX;
        lastMousePosition.y = event.clientY;
        // console.log("lastx: " + lastMousePosition.x + " lasty: " + lastMousePosition.y);
    });

// delay til page load
    // TODO Master "onMounted" definitions

    // mainly for the image optimization. 1024 is tailwinds lg.
    const breakpoints = [
        { width: 2560, suffix: '-2560' },
        { width: 1920, suffix: '-1920' },
        { width: 1600, suffix: '-1600' },
        { width: 1200, suffix: '-1200' },
        { width: 1024, suffix: '-1024' },
        { width: 834, suffix: '-834' },
        { width: 600, suffix: '-600' },
        { width: 414, suffix: '-414' },
        { width: 360, suffix: '-360' },
        { width: 320, suffix: '-320' }
    ];


    const imagesInfo = [
        {
            id: "redhead",
            baseName: "/images/animated-logo/redhead"
        },
        {
            id: "blueninja",
            baseName: "/images/animated-logo/blue-ninja"
        },
        {
            id: "blackcat",
            baseName: "/images/animated-logo/black-cat"
        },
        {
            id: "tanwoman",
            baseName: "/images/animated-logo/tan-woman"
        },
        {
            id: "orangewoman",
            baseName: "/images/animated-logo/orange-woman"
        }
    ];

    let image_index = 0;
    let old_width = window.innerWidth;
    // this dies on resize, then reruns.
    // this is recursive to load all the images for the logo svg slowly
    function loadNextImage() {
        if (image_index < imagesInfo.length) {
            const imageElement = document.getElementById(imagesInfo[image_index].id);
            if (imageElement) {
                const screenWidth = window.innerWidth;
                if (old_width !== screenWidth) {
                    return;
                }
                const breakpoint = breakpoints.find(bp => screenWidth >= bp.width);

                const suffix = breakpoint ? breakpoint.suffix : '';
                const fileName = `${imagesInfo[image_index].baseName}${suffix}.jpg`;
                imageElement.setAttributeNS('http://www.w3.org/1999/xlink', 'href', fileName);
                console.log("loading image: " + fileName);
                image_index++;
                setTimeout(loadNextImage, 7500); // Wait for 7.5 seconds before loading the next image
            } else {
                image_index = 0
            }
        }
    }
    loadNextImage(); // first run

    // On resize, load the images
    // window.addEventListener('resize', () => {
    //     old_width = window.innerWidth;
    //     image_index = 0;
    //     loadNextImage();
    // });

    let currentIndex = 0;

    function animateCircle() {
        const circles = document.querySelectorAll('circle.cls-3-2');

        if (circles.length === 0) return;

        // get previous index
        const prevIndex = currentIndex === 0 ? circles.length - 1 : currentIndex - 1;
        const circle = circles[currentIndex];

        // Get the bounding rectangle of the SVG element
        const svgRect = document.getElementById('joebeze_logo_lazer_anim').getBoundingClientRect();
        const margin = parseFloat(getComputedStyle(document.getElementById('logo-container')).marginLeft);
        const svgRippleRect = document.getElementById('ripple-effect-bg').getBoundingClientRect();
        const viewBox = document.getElementById('joebeze_logo_lazer_anim').viewBox.baseVal;

        // Calculate the scale factors based on the viewBox dimensions
        const scaleX = svgRect.width / viewBox.width;
        const scaleY = svgRect.height / viewBox.height;

        // Calculate the mouse position relative to the SVG's viewBox coordinates
        const svgX = lastMousePosition.x - 60 > 1200 ? 1200 : lastMousePosition.x - 50;
        const svgY = lastMousePosition.y + (svgRippleRect.height/2) - 10 > 800 ? 800 : lastMousePosition.y + (svgRippleRect.height/2) - 10;

        // Adjust the position to align with the pointer finger
        const adjustedSvgX = svgX;
        const adjustedSvgY = svgY;

        // Put a small dot on the same location that is upper level and 100% visible
        // const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        // dot.setAttribute('cx', adjustedSvgX);
        // dot.setAttribute('cy', adjustedSvgY);
        // dot.setAttribute('r', '1');
        // dot.setAttribute('fill', 'white');
        // dot.setAttribute('stroke', 'white');
        // dot.setAttribute('stroke-width', '1');
        // dot.style.transition = 'r 1s';
        // document.getElementById('joebeze_logo_lazer_anim').appendChild(dot);


        // Start expanding without transition for position change
        setTimeout(() => {
            //change location of circles
            circle.setAttribute('cx', adjustedSvgX);
            circle.setAttribute('cy', adjustedSvgY);
            circle.style.transition = 'r 29s';
            const viewportWidth = window.innerWidth;
            const radius = (2500 / 1920) * viewportWidth;
            // Set the radius attribute
            circle.setAttribute('r', radius.toString());

            circle.setAttribute('r', '286.46vw');  // Use 2500 for half of 5000 to simulate radius expansion
        }, 10);

        // Reset all circles
        circles.forEach((c, index) => {
            let lastIndex = (currentIndex - 1) % circles.length;
            if (index === currentIndex) {
                c.style.zIndex = '19';
            } else if (index === lastIndex) {
                c.setAttribute('cx', adjustedSvgX);
                c.setAttribute('cy', adjustedSvgY);
                c.style.zIndex = '18';
            } else {
                c.setAttribute('cx', adjustedSvgX);
                c.setAttribute('cy', adjustedSvgY);
                c.style.transition = 'r 1s';
                c.setAttribute('r', '0.1');
                c.style.zIndex = '17';
            }

        });

        // set z-index of current circle to 89 and previous circle to 88
        circle.style.zIndex = '19';
        circles[prevIndex].style.zIndex = '18';

        currentIndex = (currentIndex + 1) % circles.length;
    }

    setTimeout(animateCircle, 10500)

    // Start the animation cycle
    setInterval(animateCircle, 20500);


    // Randomly choose between the images
    let options = [
        "/images/Screenshot 2024-03-23 100050.jpg",
        "/images/noita-logo.gif",
        "/images/logo-bg-image-003.jpg",
        "/images/logo-bg-image-004.jpg",
        "/images/logo-bg-image-006.jpg",
        "/images/logo-bg-image-007.jpg"
    ];// Set the background to the random image


    // Pick a random index based on the length of the options array

    // Set initial fill for the filled logo
    document.querySelectorAll('#joebeze_logo_filled .cls-2-1').forEach(path => {
        path.style.fill = 'url(#tessPattern)';
    });

    // Fade out the background and filled logo
    setTimeout(() => {

        document.getElementById('logo-background').classList.add('fade-out');

        // add an animation to fade out the filled logo
        document.getElementById('joebeze_logo_filled').style.animation = 'fadeOut 2s ease-in-out forwards';
    }, 2000);

    // Fade in the laser animation
    setTimeout(() => {
        document.getElementById('joebeze_logo_lazer_anim').style.visibility = 'visible';
        const laserWriter = new LaserWriter("canvas", "canvas2", "joebeze_logo_lazer_anim");
        laserWriter.traceSVG();
        laserWriter.traceBorder();
        laserWriter.draw();
        // let rand = Math.floor(Math.random() * options.length);
        // let imageUrl = options[rand];
        // document.getElementById('logo-background').style.backgroundImage = `url('${imageUrl}')`;

    }, 4000);

    // Fade in the filled logo with the screenshot pattern and fade the background to the screenshot
    setTimeout(() => {
        document.querySelectorAll('#joebeze_logo_filled .cls-2-1').forEach(path => {
            path.style.fill = 'white';
        });
        document.getElementById('joebeze_logo_filled').style.visibility = 'visible';
        document.getElementById('joebeze_logo_filled').style.opacity = '1';
        // set animation
        document.getElementById('joebeze_logo_filled').style.animation = 'fadeIn 2s ease-in-out forwards';
    }, 11000);
    setTimeout(() => {
        const paths = document.querySelectorAll('#joebeze_logo_lazer_anim .cls-1');
        paths.forEach(path => {
            // Change the stroke color
            path.style.stroke = '#012'; // Change to your desired color
        });
        // Update #joebeze_logo_lazer_anim .cls-1 transition to stroke 1s ease
        paths.forEach(path => {
            path.style.transition = 'stroke 1s ease';
        });
    }, 13000);


    // Fade the filled logo to white
    // setTimeout(() => {
    //
    //     // Fix background color to show the image and be transparent
    //     document.getElementById('logo-background').style.backgroundColor = 'transparent';
    //
    //
    //     document.getElementById('logo-background').style.opacity = '1';
    //
    //
    //
    //     // Set up a timer to transition to the next image every 5 seconds
    //     let currentIndex = Math.floor(Math.random() * options.length);
    //     setInterval(() => {
    //         currentIndex = (currentIndex + 1) % options.length;
    //         let nextImageUrl = options[currentIndex];
    //
    //         // Transition to the next image over a 2-second duration
    //         document.getElementById('logo-background').style.transition = 'background-image 2s';
    //         document.getElementById('logo-background').style.backgroundImage = `url('${nextImageUrl}')`;
    //     }, 4000);
    //
    // }, 13000);
});

</script>

<style>
/* svg 1 - joebeze_logo_lazer_anim */
.cls-1 {
    fill: transparent;
    stroke-width: 0px;
}

/* joebeze_logo_filled */
.cls-2-1 {
    fill: url(#tessPattern);
    font-family: NasalizationRg-Regular, Nasalization;
    font-size: 56px;
    transition: fill 2s ease;
}

.cls-2-2 {
    letter-spacing: -.01em;
}

.cls-2-3 {
    letter-spacing: -.02em;
}

.cls-2-4 {
    letter-spacing: -.02em;
}

/* ripple-effect-bg */
.cls-3-1 {
    clip-path: url(#clippath-2);
}

.cls-3-2 {
    fill: none;
    stroke-width: 0px;
}

.cls-3-3 {
    clip-path: url(#clippath-1);
}

.cls-3-4 {
    clip-path: url(#clippath-4);
}

.cls-3-5 {
    clip-path: url(#clippath);
}

.cls-3-6 {
    clip-path: url(#clippath-3);
}

.cls-3-7 {
    clip-path: url(#clippath-5);
}

/* Actual Styling not cut from the SVGS */


 /*Top Element */
.nav_container {
    background-image: url("/images/bytebeze-banner-tess.png");
    background-repeat: repeat;
}

#logo-background {
    background-position: center bottom;
    background-size: cover;
}

#logo-background.fade-out {
    opacity: 0;
    background-color: transparent;
    transition: opacity 2s, background-color 2s; /* Adjust the time as needed */
}





@keyframes fadeIn {
    0% {
        opacity: 0;
        visibility: hidden;
    }
    100% {
        opacity: 1;
        visibility: visible;
    }
}

@keyframes fadeOut {
    0% {
        opacity: 1;
        visibility: visible;
    }
    100% {
        opacity: 0;
        visibility: hidden;
    }
}
</style>
